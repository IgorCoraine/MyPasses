<!DOCTYPE html>
<html>
<head>
    <title>Add Password - MyPasses</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <h2>Add New Password</h2>
    <form method="POST" action="{{ url_for('add_password') }}">
        <div>
            <label for="title">Title:</label>
            <input type="text" id="title" name="title" required>
        </div>
        <div>
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" required>
        </div>
        <div>
            <label for="password">Password:</label>
            <div class="password-container">
                <input type="password" id="password" name="password" required>
                <i class="fas fa-eye" id="togglePassword"></i>
            </div>
            <button type="button" onclick="generatePassword()">Generate Password</button>
        </div>
        <div>
            <label for="url">URL:</label>
            <input type="url" id="url" name="url">
        </div>
        <div>
            <label for="notes">Notes:</label>
            <textarea id="notes" name="notes"></textarea>
        </div>
        <button type="submit">Save Password</button>
    </form>
    <a href="{{ url_for('dashboard') }}">Back to Dashboard</a>
</body>
</html>

<script>
async function generatePassword() {
    try {
        const response = await fetch('/generate_password', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        const data = await response.json();
        document.getElementById('password').value = data.password;
        document.getElementById('password').type = 'text';  // Show the password
        setTimeout(() => {
            document.getElementById('password').type = 'password';  // Hide after 3 seconds
        }, 2000);
    } catch (error) {
        console.error('Error generating password:', error);
    }
}
</script>

<script>
    const togglePassword = document.querySelector('#togglePassword');
    const password = document.querySelector('#password');
    
    togglePassword.addEventListener('click', function () {
        const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
        password.setAttribute('type', type);
        this.classList.toggle('fa-eye-slash');
    });
</script>
